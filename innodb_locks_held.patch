diff -r f5e2d757289d innobase/include/srv0srv.h
--- a/innobase/include/srv0srv.h	Fri Nov 07 06:47:12 2008 -0800
+++ b/innobase/include/srv0srv.h	Fri Nov 07 06:49:25 2008 -0800
@@ -78,6 +78,8 @@
 extern ulint	srv_log_file_size;
 extern ulint	srv_log_buffer_size;
 extern ulong	srv_flush_log_at_trx_commit;
+extern ulong	srv_show_locks_held;
+extern ulong	srv_show_verbose_locks;
 
 extern byte	srv_latin1_ordering[256];/* The sort order table of the latin1
 					character set */
diff -r f5e2d757289d innobase/lock/lock0lock.c
--- a/innobase/lock/lock0lock.c	Fri Nov 07 06:47:12 2008 -0800
+++ b/innobase/lock/lock0lock.c	Fri Nov 07 06:49:25 2008 -0800
@@ -4178,6 +4178,7 @@
 #endif /* UNIV_SYNC_DEBUG */
 	}
 
+	if ( srv_show_verbose_locks ) {
 	for (i = 0; i < lock_rec_get_n_bits(lock); i++) {
 
 		if (lock_rec_get_nth_bit(lock, i)) {
@@ -4195,6 +4196,7 @@
 			putc('\n', file);
 		}
 	}
+	} /* srv_show_verbose_locks */
 
 	mtr_commit(&mtr);
 	if (UNIV_LIKELY_NULL(heap)) {
@@ -4366,7 +4368,7 @@
 		}
 	}
 
-	if (!srv_print_innodb_lock_monitor) {
+	if (!srv_print_innodb_lock_monitor && !srv_show_locks_held) {
 	  	nth_trx++;
 	  	goto loop;
 	}
@@ -4423,9 +4425,9 @@
 
 	nth_lock++;
 
-	if (nth_lock >= 10) {
+	if (nth_lock >= srv_show_locks_held) {
 		fputs(
-		"10 LOCKS PRINTED FOR THIS TRX: SUPPRESSING FURTHER PRINTS\n",
+		"TOO MANY LOCKS PRINTED FOR THIS TRX: SUPPRESSING FURTHER PRINTS\n",
 			file);
 	
 		nth_trx++;
diff -r f5e2d757289d innobase/srv/srv0srv.c
--- a/innobase/srv/srv0srv.c	Fri Nov 07 06:47:12 2008 -0800
+++ b/innobase/srv/srv0srv.c	Fri Nov 07 06:49:25 2008 -0800
@@ -114,6 +114,8 @@
 ulint	srv_log_file_size	= ULINT_MAX;	/* size in database pages */ 
 ulint	srv_log_buffer_size	= ULINT_MAX;	/* size in database pages */ 
 ulong	srv_flush_log_at_trx_commit = 1;
+ulint	srv_show_locks_held	= 10;
+ulint	srv_show_verbose_locks	= 0;
 
 byte	srv_latin1_ordering[256]	/* The sort order table of the latin1
 					character set. The following table is
diff -r f5e2d757289d libmysqld/set_var.cc
--- a/libmysqld/set_var.cc	Fri Nov 07 06:47:12 2008 -0800
+++ b/libmysqld/set_var.cc	Fri Nov 07 06:49:25 2008 -0800
@@ -460,6 +460,12 @@
 sys_var_long_ptr  sys_innodb_flush_log_at_trx_commit(
                                         "innodb_flush_log_at_trx_commit",
                                         &srv_flush_log_at_trx_commit);
+sys_var_long_ptr  sys_innodb_show_locks_held(
+                                        "innodb_show_locks_held",
+                                        &srv_show_locks_held);
+sys_var_long_ptr  sys_innodb_show_verbose_locks(
+                                        "innodb_show_verbose_locks",
+                                        &srv_show_verbose_locks);
 #endif
 
 /* Condition pushdown to storage engine */
@@ -808,6 +814,8 @@
   &sys_innodb_thread_concurrency,
   &sys_innodb_commit_concurrency,
   &sys_innodb_flush_log_at_trx_commit,
+  &sys_innodb_show_locks_held,
+  &sys_innodb_show_verbose_locks,
 #endif
   &sys_trust_routine_creators,
   &sys_trust_function_creators,
@@ -923,6 +931,8 @@
   {"innodb_file_io_threads", (char*) &innobase_file_io_threads, SHOW_LONG },
   {"innodb_file_per_table", (char*) &innobase_file_per_table, SHOW_MY_BOOL},
   {sys_innodb_flush_log_at_trx_commit.name, (char*) &sys_innodb_flush_log_at_trx_commit, SHOW_SYS},
+  {sys_innodb_show_locks_held.name, (char*) &sys_innodb_show_locks_held, SHOW_SYS },
+  {sys_innodb_show_verbose_locks.name, (char*) &sys_innodb_show_verbose_locks, SHOW_SYS },
   {"innodb_flush_method",    (char*) &innobase_unix_file_flush_method, SHOW_CHAR_PTR},
   {"innodb_force_recovery", (char*) &innobase_force_recovery, SHOW_LONG },
   {"innodb_lock_wait_timeout", (char*) &innobase_lock_wait_timeout, SHOW_LONG },
diff -r f5e2d757289d patch_info/innodb_locks_held.info
--- /dev/null	Thu Jan 01 00:00:00 1970 +0000
+++ b/patch_info/innodb_locks_held.info	Fri Nov 07 06:49:25 2008 -0800
@@ -0,0 +1,6 @@
+File=innodb_locks_held.patch
+Name=Add locks held, remove locked records in SHOW INNODB STATUS
+Version=1.0
+Author=Baron Schwartz <baron@xaprb.com>
+License=GPL
+Comment=Bug #29126 fix
diff -r f5e2d757289d sql/ha_innodb.h
--- a/sql/ha_innodb.h	Fri Nov 07 06:47:12 2008 -0800
+++ b/sql/ha_innodb.h	Fri Nov 07 06:49:25 2008 -0800
@@ -238,6 +238,8 @@
 extern ulong srv_io_capacity;
 extern ulong srv_read_ahead;
 extern ulong srv_adaptive_checkpoint;
+extern ulong srv_show_locks_held;
+extern ulong srv_show_verbose_locks;
 }
 
 bool innobase_init(void);
diff -r f5e2d757289d sql/mysqld.cc
--- a/sql/mysqld.cc	Fri Nov 07 06:47:12 2008 -0800
+++ b/sql/mysqld.cc	Fri Nov 07 06:49:25 2008 -0800
@@ -4961,6 +4961,8 @@
   OPT_INNODB_MAX_PURGE_LAG,
   OPT_INNODB_FILE_IO_THREADS,
   OPT_INNODB_LOCK_WAIT_TIMEOUT,
+  OPT_INNODB_SHOW_LOCKS_HELD,
+  OPT_INNODB_SHOW_VERBOSE_LOCKS,
   OPT_INNODB_THREAD_CONCURRENCY,
   OPT_INNODB_COMMIT_CONCURRENCY,
   OPT_INNODB_FORCE_RECOVERY,
@@ -5297,6 +5299,14 @@
    (gptr*) &srv_flush_log_at_trx_commit,
    (gptr*) &srv_flush_log_at_trx_commit,
    0, GET_ULONG, OPT_ARG,  1, 0, 2, 0, 0, 0},
+  {"innodb_show_locks_held", OPT_INNODB_SHOW_LOCKS_HELD,
+   "Number of locks held to print for each InnoDB transaction in SHOW INNODB STATUS.",
+   (gptr*) &srv_show_locks_held, (gptr*) &srv_show_locks_held,
+   0, GET_LONG, OPT_ARG, 10, 0, 1000, 0, 1, 0},
+  {"innodb_show_verbose_locks", OPT_INNODB_SHOW_VERBOSE_LOCKS,
+   "Whether to show records locked in SHOW INNODB STATUS.",
+   (gptr*) &srv_show_verbose_locks, (gptr*) &srv_show_verbose_locks,
+   0, GET_LONG, OPT_ARG, 0, 0, 1, 0, 1, 0},
   {"innodb_flush_method", OPT_INNODB_FLUSH_METHOD,
    "With which method to flush data.", (gptr*) &innobase_unix_file_flush_method,
    (gptr*) &innobase_unix_file_flush_method, 0, GET_STR, REQUIRED_ARG, 0, 0, 0,
diff -r f5e2d757289d sql/set_var.cc
--- a/sql/set_var.cc	Fri Nov 07 06:47:12 2008 -0800
+++ b/sql/set_var.cc	Fri Nov 07 06:49:25 2008 -0800
@@ -487,6 +487,12 @@
                                               &srv_read_ahead);
 sys_var_long_ptr	sys_innodb_adaptive_checkpoint("innodb_adaptive_checkpoint",
                                                       &srv_adaptive_checkpoint);
+sys_var_long_ptr  sys_innodb_show_locks_held(
+                                        "innodb_show_locks_held",
+                                        &srv_show_locks_held);
+sys_var_long_ptr  sys_innodb_show_verbose_locks(
+                                        "innodb_show_verbose_locks",
+                                        &srv_show_verbose_locks);
 #endif
 
 /* Condition pushdown to storage engine */
@@ -843,6 +849,8 @@
   &sys_innodb_io_capacity,
   &sys_innodb_read_ahead,
   &sys_innodb_adaptive_checkpoint,
+  &sys_innodb_show_locks_held,
+  &sys_innodb_show_verbose_locks,
 #endif
   &sys_trust_routine_creators,
   &sys_trust_function_creators,
@@ -958,6 +966,8 @@
   {"innodb_file_io_threads", (char*) &innobase_file_io_threads, SHOW_LONG },
   {"innodb_file_per_table", (char*) &innobase_file_per_table, SHOW_MY_BOOL},
   {sys_innodb_flush_log_at_trx_commit.name, (char*) &sys_innodb_flush_log_at_trx_commit, SHOW_SYS},
+  {sys_innodb_show_locks_held.name, (char*) &sys_innodb_show_locks_held, SHOW_SYS },
+  {sys_innodb_show_verbose_locks.name, (char*) &sys_innodb_show_verbose_locks, SHOW_SYS },
   {"innodb_flush_method",    (char*) &innobase_unix_file_flush_method, SHOW_CHAR_PTR},
   {"innodb_force_recovery", (char*) &innobase_force_recovery, SHOW_LONG },
   {"innodb_lock_wait_timeout", (char*) &innobase_lock_wait_timeout, SHOW_LONG },
