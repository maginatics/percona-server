DROP TABLE IF EXISTS t1, t2;
CREATE TABLE t1 (x INT) ENGINE=InnoDB;
INSERT INTO t1 VALUES (1),(2),(3),(4),(5);
ib_modified_log_1
1st restart
INSERT INTO t1 VALUES (1),(2),(3),(4),(5);
ib_modified_log_1
ib_modified_log_2
2nd restart
INSERT INTO t1 VALUES (1),(2),(3),(4),(5);
ib_modified_log_1
ib_modified_log_2
ib_modified_log_3
3rd restart
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
INSERT INTO t1 SELECT x FROM t1;
CREATE TABLE t2 (x INT) ENGINE=InnoDB;
INSERT INTO t2 VALUES (1),(2),(3),(4),(5);
ib_modified_log_1
ib_modified_log_2
SET GLOBAL INNODB_FAST_SHUTDOWN=2;
4th restart
ib_modified_log_1
ib_modified_log_2
ib_modified_log_3
5th restart
INSERT INTO t1 VALUES (1),(2),(3),(4),(5);
ib_modified_log_1
ib_modified_log_2
7th restart
INSERT INTO t1 VALUES (1),(2),(3),(4),(5);
ib_modified_log_1
8th restart
call mtr.add_suppression("InnoDB: Warning: truncated block detected.*");
ib_modified_log_1
ib_modified_log_2
9th restart
INSERT INTO t1 SELECT x FROM t1;
ERROR HY000: Lost connection to MySQL server during query
INSERT INTO t1 VALUES (1),(2),(3),(4),(5);
ib_modified_log_1
ib_modified_log_2
ib_modified_log_3
10th restart
DROP TABLE t1, t2;
SET GLOBAL innodb_fast_shutdown=0;
11th restart
SELECT @@innodb_read_only;
@@innodb_read_only
1
SELECT @@innodb_track_changed_pages;
@@innodb_track_changed_pages
1
12th restart
